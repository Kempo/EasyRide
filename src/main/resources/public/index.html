<html>
<head>
    <script src="./jquery.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            $("#rides").change(function () {
                $('#val').text(this.value.replace(/C:\\fakepath\\/i, ''));
                var fr = new FileReader();
                fr.onload = function () {
                    $("#contents").val(this.result);
                };
                fr.readAsText(this.files[0]);
                
            });
        });

        function selectFile() {
            $("#rides").trigger('click');
        }
        function sendData() {
            var fr = new FileReader();
            fr.onload = function(event) {
                var result = event.target.result;
                $.post("/rides", result, function(result, error) {
                    result = result.replace(/\n/g, "<br>");
                    $(".result").html(result);
                });
            };
            var rides = $("#rides");
            var files = rides[0]['files'];
            var file = files[0];
            fr.readAsText(file, 'ASCII');
        }
        
    </script>
    <title> EasyRide </title>
    <link rel="stylesheet" href="styles.css">
</head>
    
    
<body>
    <div id="title"> 
        <h1> EasyRide </h1>
    </div>
    
    <div id="instructions">
        <h1>Upload a .tsv file (tab-separated value) with the following format:</h1>
        <p>  
        name | address | designation (either "driver" or "rider") | number of spaces (if driver). 
        </p>
    </div>
    
    <div id="exampleInput">
        <p>
            <b>Example Input:</b> <br>
            billy   33  4th street  driver  3<br>
            sandy   355 5th AVE S   rider<br>
            andy    41  6th street  driver  5<br>
        </p>
    </div>
    <!-- previous stuff for note
<input id="rides" type="file" accept=".tsv">
<br>
    

<button onclick="sendData()">Submit</button>
    -->
    <div id='fileinput'>
    <input type='file' id='rides' accept='.tsv'> 
    <span id='val'></span>
    <span id='buttonSelect' onclick="selectFile();">Select File</span>
    <span id='buttonSubmit' onclick="sendData();">Submit</span>
    </div>
    
    <div>
    <textarea id="contents" rows="20" cols="70"></textarea>
    </div>
    
    <div class="result">
    </div>
    
</body>
</html>